<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<script type="text/javascript" src="/pub/TWiki/JQueryPlugin/jquery.js"></script>
<script type="text/javascript" src="/pub/TWiki/JQueryPlugin/jquery-migrate.js"></script>
<link rel="stylesheet" href="/pub/TWiki/JQueryPlugin/jquery-all.css" type="text/css" media="all" />
<script type="text/javascript" src="/pub/TWiki/JQueryPlugin/jquery-all.js"></script>
<title> Homework8 &lt; CS361fall13 &lt; TWiki</title>

<link rel="icon" href="https://www1.cs.uic.edu/images/favicon.ico" type="image/x-icon" />
<link rel="alternate" href="https://www.cs.uic.edu/bin/edit/CS361fall13/Homework8?_T=2018-11-25" type="application/x-wiki" title="edit Homework8" />
<link rel="shortcut icon" href="https://www1.cs.uic.edu/images/favicon.ico" type="image/x-icon" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/CS361fall13/WebRss" />
<base href="https://www.cs.uic.edu/bin/view/CS361fall13/Homework8"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/pub/TWiki/PatternSkin/pattern.js"></script>
<style type="text/css" media="all">
@import url('/pub/TWiki/TWikiTemplates/base.css');
</style>
<style type="text/css" media="all">
#patternTopBar,
#patternClearHeaderCenter,
#patternClearHeaderLeft,
#patternClearHeaderRight,
#patternTopBarContentsOuter,
#patternTopBarContents {
/*	height:64px; */ /* top bar height; make room for header columns */
	overflow:hidden;
}
#patternOuter {
	margin-left:14em;
}
#patternLeftBar {
	width:14em;
	margin-left:-14em;
}
</style>
<style type="text/css" media="all">
@import url('/pub/TWiki/PatternSkin/layout.css');
@import url('/pub/TWiki/PatternSkin/style.css');
@import url('/pub/TWiki/PatternSkin/colors.css');
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	.patternBookView .twikiTopRow,
	.patternWebIndicator a img,
	.patternWebIndicator a:hover img {
		background-color:#D0D0D0;
	}
	#patternTopBarContents { background-image:url(none); background-repeat:no-repeat;}
	
	.patternBookView {
		border-color:#D0D0D0;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/pub/TWiki/PreviewBackground/preview2bg.gif");*/
	}
	
</style><style type="text/css" media="all">

@import url('/pub/Main/WebPreferences/mainweb.css');

</style>
<style type="text/css" media="all">
	@import url("/pub/TWiki/PatternSkin/print.css");
</style>
<!--[if IE]><style type="text/css" media="screen">
pre {
	overflow-x:auto;
	padding-bottom:expression(this.scrollWidth > this.offsetWidth ? 16 : 0);
}
</style>
<![endif]-->
<!--[if lte IE 6]> 
<style type="text/css">
#patternLeftBar {
	position:relative; /* IE 5.5 needs this or the contents won't show outside the parent container on print. IE 6.0 needs it only during printable copy! */
}
</style><![endif]-->
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script>

<!-- Google Analytics Snippet -->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17081517-1']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);

  (function() {
	 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + 
'.google-analytics.com/ga.js';
	 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- /Google Analytics Snippet -->
</head>
<body class="patternViewPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternWrapper"><div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain"><div id="patternClearHeaderCenter"></div>
<div id="patternMainContents"><div class="patternTop"><span class="patternHomePath twikiLeft"><a href="/bin/view/Main/WebHome" class="twikiLink">TWiki</a><span class='twikiSeparator'>&gt;</span><img src="/pub/TWiki/TWikiDocGraphics/web-bg-small.gif" border="0" alt="" width="13" height="13" style="background-color:#D0D0D0" />&nbsp;<a href="/bin/view/CS361fall13/WebHome">CS361fall13 Web</a><span class='twikiSeparator'>&gt;</span><a href="https://www.cs.uic.edu/bin/view/CS361fall13/Homework8" title='Topic revision: 2 (2013-10-30 - 17:21:09)'>Homework8</a> <span class='patternRevInfo'>(2013-10-30, Main.jakob)</span></span><!-- /patternHomePath--><span class="patternToolBar twikiRight"><span><a href='https://www.cs.uic.edu/bin/edit/CS361fall13/Homework8?t=1543180306' rel='nofollow' title='Edit this topic text' accesskey='e'><span class='twikiAccessKey'>E</span>dit</a></span><span><a href='/bin/attach/CS361fall13/Homework8' rel='nofollow' title='Attach an image or document to this topic' accesskey='a'><span class='twikiAccessKey'>A</span>ttach</a></span></span><!-- /patternToolBar--><br class="twikiClear" /></div><!--/patternTop--><div class="twikiContentHeader"></div><div class="patternContent"><div class="patternTopic"> <h1><a name="Homework_8_Concurrent_Elevator_C"></a> Homework 8 - Concurrent Elevator Controller </h1>
<p />
A <code>M</code> -story highrise has <code>N</code> elevators in a single "elevator bank", each able to serve every floor of the building. Contrary from most elevator designs, there are no buttons to choose a destination floor inside the elevator. Instead, the elevator lobby at each floor has <code>M</code> individual "destination floor" buttons, and passengers choose their destination by pushing the appropriate button. Once a button is pushed, a display near the buttons tells the passenger which elevator door to wait by. In this assignment, elevators serve only one passenger at a time.
<p />
Your assignment is to create an elevator controller that ensures that all passengers receive service, minimizing the mean and max time between button push and arrival at the destination floor.
<p />
<h2><a name="The_code"></a> The code </h2>
<p />
The homework 8 template is a multithreaded program which simulates passengers and elevator travel. There is one thread per elevator, and one thread per passenger. There is a fixed number of passengers, that embark on a number of trips each. These threads interact with each other through a central elevator controller, which is your responsibility to implement.
<p />
The central controller responds to the following two function calls:
<p />
%CODE{ lang="c" }%
<p />
/* called whenever a passenger pushes a button in the elevator lobby. call enter / exit to move passengers into / out of elevator return only after the passenger has been delivered to requested floor */ 
<p />
void passenger_request(int passenger, int from_floor, int to_floor, void (*enter)(int, int), void(*exit)(int, int));
<p />
/* called whenever the elevator needs to know what to do next. call move_direction with direction -1 to descend, 1 to ascend. must call door_open before letting passengers in, and door_close before moving the elevator */ 
<p />
void elevator_ready(int elevator, int at_floor, void(*move_direction)(int, int), void(*door_open)(int), void(*door_close)(int));
<p />
%ENDCODE%
<p />
<h2><a name="Performance_Expectations"></a> Performance Expectations </h2>
<p />
The template code works correctly, but is terribly slow. In part, this is because passengers often "miss" the elevator (don't get in in time), or miss their floor (stay on the elevator). In part, it is because the elevator stops at every floor, and we only use one elevator.
<p />
For a full score, have a fully working solution that uses all available elevators, and finishes the final case in "make test" in at most 20 seconds without using more than 10% of the CPU during that time.
<p />
<h2><a name="Notes"></a> Notes </h2>
<p /> <ul>
<li> Every passenger pushes a button.
</li> <li> Passengers can't change their minds, and will wait until they are told to enter the elevator, using the <code>enter()</code> callback function
</li> <li> Passengers will stay in the elevator until they are told to leave, using the <code>exit()</code> callback function.
</li> <li> Elevators can hold at most one passenger.
</li> <li> The program finishes after all passengers have been served, and all functions have returned.
</li></ul> 
<p />
<h2><a name="Hints"></a> Hints </h2>
<p /> <ul>
<li> Start by making sure your passengers have time to get on and off the elevator. You can do this with condition variables (pthread_cond_t), or barriers (pthread_barrier_t). A barrier-based solution seems easier. Use one barrier to make the passenger wait for the door to open, and another to make the elevator wait for the passenger to enter.
</li> <li> The template solution can a single set of global variables. You'll probably want to have one set per elevator. Define an elevator struct that holds all your necessary state per elevator, and make an array of such structs.
</li> <li> Handling multiple elevators should be the last item on your TODO list. An easy way to do it is to randomly decide, for each passenger, which elevator they should use, independent of everything else. Then you can treat each elevator+passengers group separately.
</li> <li> You could use an extra set of mutexes around the whole <code>passenger_request()</code> function to make sure only one user's request is handled by each elevator at one time.
</li></ul> 
<p />
<h2><a name="Logging"></a> Logging </h2>
<p />
To add more logging output, try using the log() function instead of printf.
<p />
<code>log(loglevel, format_string, parameters)</code>
<p />
works just like <code>fprintf(stderr,...)</code> except it only prints if the configured log level is higher than the loglevel argument provided. To set the log level to, for example, 8 use the following flag to gcc <code>-DLOGLEVEL=8</code>
<p />
<h2><a name="Good_documents_on_threaded_progr"></a> Good documents on threaded programming </h2>
<p />
<a href="http://www.ibm.com/developerworks/linux/library/l-posix1.html?S_TACT=105AGX03&amp;S_CMP=EDU" target="_top">http://www.ibm.com/developerworks/linux/library/l-posix1.html?S_TACT=105AGX03&amp;S_CMP=EDU</a>
<p />
<a href="http://www.ibm.com/developerworks/linux/library/l-posix2/?S_TACT=105AGX03&amp;S_CMP=EDU" target="_top">http://www.ibm.com/developerworks/linux/library/l-posix2/?S_TACT=105AGX03&amp;S_CMP=EDU</a>
<p />
<a href="http://www.ibm.com/developerworks/linux/library/l-posix3/index.html?S_TACT=105AGX03&amp;S_CMP=EDU" target="_top">http://www.ibm.com/developerworks/linux/library/l-posix3/index.html?S_TACT=105AGX03&amp;S_CMP=EDU</a>
<p />
<a href="https://computing.llnl.gov/tutorials/pthreads/#ConVarSignal" target="_top">https://computing.llnl.gov/tutorials/pthreads/#ConVarSignal</a>
<p />
<a href="http://pages.cs.wisc.edu/~travitch/pthreads_primer.html" target="_top">http://pages.cs.wisc.edu/~travitch/pthreads_primer.html</a> </div><!-- /patternTopic-->
<div class="twikiContentFooter"></div></div><!-- /patternContent-->
<a name="topic-actions"></a><div class="patternTopicActions"><div class="patternTopicAction"><span class="patternActionButtons"><span><a href='https://www.cs.uic.edu/bin/edit/CS361fall13/Homework8?t=1543180306' rel='nofollow' title='Edit this topic text' accesskey='e'><span class='twikiAccessKey'>E</span>dit</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/attach/CS361fall13/Homework8' rel='nofollow' title='Attach an image or document to this topic' accesskey='a'><span class='twikiAccessKey'>A</span>ttach</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/view/CS361fall13/Homework8?cover=print' rel='nofollow' title='Printable version of this topic' accesskey='p'><span class='twikiAccessKey'>P</span>rint version</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><span><a href='/bin/rdiff/CS361fall13/Homework8?type=history' rel='nofollow' title='View total topic history' accesskey='h'><span class='twikiAccessKey'>H</span>istory</a></span>: r2&nbsp;<a rel="nofollow" href="/bin/rdiff/CS361fall13/Homework8?rev1=2;rev2=1">&lt;</a>&nbsp;<a rel="nofollow" href="/bin/view/CS361fall13/Homework8?rev=1">r1</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/oops/CS361fall13/Homework8?template=backlinksweb' rel='nofollow' title='Search the CS361fall13 Web for topics that link to here' accesskey='b'><span class='twikiAccessKey'>B</span>acklinks</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/view/CS361fall13/Homework8?raw=on' rel='nofollow' title='View raw text without formatting' accesskey='r'><span class='twikiAccessKey'>R</span>aw View</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='https://www.cs.uic.edu/bin/edit/CS361fall13/Homework8?t=1543180306;nowysiwyg=1' rel='nofollow' title='Raw Edit this topic text' accesskey='w'>Ra<span class='twikiAccessKey'>w</span> edit</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/oops/CS361fall13/Homework8?template=oopsmore&amp;param1=2&amp;param2=2' rel='nofollow' title='Delete or rename this topic; set parent topic; view and compare revisions' accesskey='m'><span class='twikiAccessKey'>M</span>ore topic actions</a></span></span></div><!--/patternTopicAction--></div><!--/patternTopicActions--><div class="patternInfo twikiGrayText"><div class="patternRevInfo">Topic revision: r2 - 2013-10-30 - 17:21:09 - Main.jakob</div><!-- /patternRevInfo--><div class="patternMoved"></div><!-- /patternMoved--></div><!-- /patternInfo-->
</div><!-- /patternMainContents-->
</div><!-- /patternMain--><div id="patternLeftBar"><div id="patternClearHeaderLeft"></div>
<div id="patternLeftBarContents"><div class="patternWebIndicator"> <ul>
<li> <a href="/bin/view/CS361fall13/WebHome" class="twikiCurrentWebHomeLink twikiLink"><img src="/pub/TWiki/TWikiDocGraphics/web-bg-small.gif" width="13" height="13" alt="Web background" title="Web background" border="0" /> CS361fall13</a>
</li></ul> 
</div> <ul>
<li> <a href="/bin/view/CS361fall13/Syllabus" class="twikiLink">Syllabus</a>
</li> <li> <a href="/bin/view/CS361fall13/CourseSchedule" class="twikiLink">Homework Schedule</a>
</li> <li> <a href="/bin/view/CS361fall13/LectureNotes" class="twikiLink">Lecture Notes</a>
</li> <li> <a href="/bin/view/CS361fall13/ReadingList" class="twikiLink">Reading List</a>
</li> <li> <a href="/bin/view/CS361fall13/AdditionalMaterial" class="twikiLink">Additional Material</a>
</li> <li> <a href="https://piazza.com/class/hjsnllvm3vc4sy" target="_top">Piazza Board</a>
</li> <li> <a href="https://jakob.signin.aws.amazon.com/console" target="_top">EC2 Sign-In Page</a>
</li></ul> 
</div><!-- /patternLeftBarContents--></div><!-- /patternLeftBar-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--></div><!-- /patternWrapper--><div id="patternTopBar"><div id="patternTopBarContents"><div id="twikiLogo" class="twikiImage">
<map id="logomap" name="logomap">
	<area shape="rect" alt="" title="" coords="144,20,317,74" href="https://www.cs.uic.edu" target=""/>
	<area shape="rect" alt="College of Engineering" title="" coords="125,76,300,91" href="http://www.engineering.uic.edu/" target=""/>
	<area shape="rect" alt="University of Illinois at Chicago" title="" coords="10,20,120,71" href="http://www.uic.edu" target=""/>
</map>
<img src="https://www.cs.uic.edu/pub/cslogo_ds.png" alt="Home - this site is powered by TWiki(R)" border="0" style="border:none;" usemap="#logomap"/>
</div>
<p />
<div style="margin-left:650px; position:relative;">
	<form name="quickSearchForm" method="get" action="https://www.google.com/search">
		<input id=quickSearchBox type="text" class="twikiInputField" name="q" size="18" maxlength="255" value=""/>
		<input type="hidden" name="sitesearch" value="cs.uic.edu"/>
	</form>
</div>
<p />
<div id="menuContainer" style="overflow:visible; position:absolute; z-index:2; width:640px; left:342px; top:58px;">
<div id="navMenu">
<ul>
<li> <a href="#">ABOUT US</a>
	<ul>
	<li><a href="https://www.cs.uic.edu/Main/AboutCS">Our Department</a></li>
	<li><a href="https://www.cs.uic.edu/bin/view/Main/NewsArchive">Recent News</a></li>
	<li><a href="https://www.cs.uic.edu/bin/view/Main/Contact">Contact Us</a></li>
	</ul>
</li>
</ul>
<ul>
<li> <a href="#">ACADEMICS</a>
	<ul>
	<li><a href="/Main/ProspectiveStudents">Prospective Students</a></li>
	<li><a href="/Main/UndergraduatePrograms">Undergraduate</a></li>
	<li><a href="/Main/ComputerScienceMinor">CS Minor</a></li>       
	<li><a href="/Main/GraduatePrograms">Graduate</a></li>
	<li><a href="/Main/Courses">Courses</a></li>
	</ul>
</li>
</ul>
<ul>
<li> <a href="#">RESEARCH</a>
	<ul>
	<li><a href="/Main/Research">Overview</a></li>
	<li><a href="/Main/Faculty-Area">By Faculty</a></li>
	<li><a href="/Main/Research#Labs">Labs</a></li>
	</ul>
</li>
</ul>
<ul>
<li> <a href="#">PEOPLE</a>
	<ul>
	<li><a href="https://www.cs.uic.edu/faculty/">Faculty</a></li>
	<li><a href="https://www.cs.uic.edu/adjuncts/">Adjuncts</a></li>
	<li><a href="https://www.cs.uic.edu/staff">Staff</a></li>
	<li><a href="/Main/Students">Students</a></li>
	<li><a href="/Main/Alumni?y=2015">Alumni</a></li>
	</ul>
</li>
</ul>
<br class="clearFloat"/>
</div>
</div></div></div><!-- /patternTopBar--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="patternWebBottomBar"><table width="100%"><tr>
<td>Copyright 2016 The Board of Trustees<br/> of the University of Illinois.<a href="webmaster@cs.uic.edu">webmaster@cs.uic.edu</a></td>
<td><a href="https://wisest.uic.edu" target=_blank>WISEST<br />Helping Women Faculty Advance<br />Funded by NSF</a> </td><td>  <a href="http://engineering.uic.edu/bin/view/COE/CollegeGift" target="_top"><img alt="" src="https://www.cs.uic.edu/pub/Main/WebHome/gift.jpg" /></a> <a href="http://www1.cs.uic.edu/www/donate.php?audience=public" target="_top"> </a> </td><td> <a target="_blank" href="http://www.cs.uic.edu/CSOpenHouse"><img alt="" src="https://www.cs.uic.edu/pub/Main/WebHome/openHouseButton.gif" border="0" /></a> </td></tr></table></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />