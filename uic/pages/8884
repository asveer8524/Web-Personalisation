<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<script type="text/javascript" src="/pub/TWiki/JQueryPlugin/jquery.js"></script>
<script type="text/javascript" src="/pub/TWiki/JQueryPlugin/jquery-migrate.js"></script>
<link rel="stylesheet" href="/pub/TWiki/JQueryPlugin/jquery-all.css" type="text/css" media="all" />
<script type="text/javascript" src="/pub/TWiki/JQueryPlugin/jquery-all.js"></script>
<title> Homework5 &lt; CS361fall13 &lt; TWiki</title>

<link rel="icon" href="https://www1.cs.uic.edu/images/favicon.ico" type="image/x-icon" />
<link rel="alternate" href="https://www.cs.uic.edu/bin/edit/CS361fall13/Homework5?_T=2018-11-25" type="application/x-wiki" title="edit Homework5" />
<link rel="shortcut icon" href="https://www1.cs.uic.edu/images/favicon.ico" type="image/x-icon" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/CS361fall13/WebRss" />
<base href="https://www.cs.uic.edu/bin/view/CS361fall13/Homework5"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/pub/TWiki/PatternSkin/pattern.js"></script>
<style type="text/css" media="all">
@import url('/pub/TWiki/TWikiTemplates/base.css');
</style>
<style type="text/css" media="all">
#patternTopBar,
#patternClearHeaderCenter,
#patternClearHeaderLeft,
#patternClearHeaderRight,
#patternTopBarContentsOuter,
#patternTopBarContents {
/*	height:64px; */ /* top bar height; make room for header columns */
	overflow:hidden;
}
#patternOuter {
	margin-left:14em;
}
#patternLeftBar {
	width:14em;
	margin-left:-14em;
}
</style>
<style type="text/css" media="all">
@import url('/pub/TWiki/PatternSkin/layout.css');
@import url('/pub/TWiki/PatternSkin/style.css');
@import url('/pub/TWiki/PatternSkin/colors.css');
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	.patternBookView .twikiTopRow,
	.patternWebIndicator a img,
	.patternWebIndicator a:hover img {
		background-color:#D0D0D0;
	}
	#patternTopBarContents { background-image:url(none); background-repeat:no-repeat;}
	
	.patternBookView {
		border-color:#D0D0D0;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/pub/TWiki/PreviewBackground/preview2bg.gif");*/
	}
	
</style><style type="text/css" media="all">

@import url('/pub/Main/WebPreferences/mainweb.css');

</style>
<style type="text/css" media="all">
	@import url("/pub/TWiki/PatternSkin/print.css");
</style>
<!--[if IE]><style type="text/css" media="screen">
pre {
	overflow-x:auto;
	padding-bottom:expression(this.scrollWidth > this.offsetWidth ? 16 : 0);
}
</style>
<![endif]-->
<!--[if lte IE 6]> 
<style type="text/css">
#patternLeftBar {
	position:relative; /* IE 5.5 needs this or the contents won't show outside the parent container on print. IE 6.0 needs it only during printable copy! */
}
</style><![endif]-->
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script>

<!-- Google Analytics Snippet -->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17081517-1']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);

  (function() {
	 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + 
'.google-analytics.com/ga.js';
	 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- /Google Analytics Snippet -->
</head>
<body class="patternViewPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternWrapper"><div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain"><div id="patternClearHeaderCenter"></div>
<div id="patternMainContents"><div class="patternTop"><span class="patternHomePath twikiLeft"><a href="/bin/view/Main/WebHome" class="twikiLink">TWiki</a><span class='twikiSeparator'>&gt;</span><img src="/pub/TWiki/TWikiDocGraphics/web-bg-small.gif" border="0" alt="" width="13" height="13" style="background-color:#D0D0D0" />&nbsp;<a href="/bin/view/CS361fall13/WebHome">CS361fall13 Web</a><span class='twikiSeparator'>&gt;</span><a href="https://www.cs.uic.edu/bin/view/CS361fall13/Homework5" title='Topic revision: 1 (2013-09-24 - 01:16:58)'>Homework5</a> <span class='patternRevInfo'>(2013-09-24, Main.jakob)</span></span><!-- /patternHomePath--><span class="patternToolBar twikiRight"><span><a href='https://www.cs.uic.edu/bin/edit/CS361fall13/Homework5?t=1543180354' rel='nofollow' title='Edit this topic text' accesskey='e'><span class='twikiAccessKey'>E</span>dit</a></span><span><a href='/bin/attach/CS361fall13/Homework5' rel='nofollow' title='Attach an image or document to this topic' accesskey='a'><span class='twikiAccessKey'>A</span>ttach</a></span></span><!-- /patternToolBar--><br class="twikiClear" /></div><!--/patternTop--><div class="twikiContentHeader"></div><div class="patternContent"><div class="patternTopic"> <h1><a name="Homework_5_homebrew_command_line"></a> Homework 5 - homebrew command line interpreter </h1>
<p />
The command line interpreter, or "shell" in Unix is an incredibly powerful tool in the hands of an experienced user. Its main function is to providing an intuitive and efficient way to combine many small commands to create new functionality.
<p />
In this homework, we will create our own shell, supporting many of the basic functions available in <code>bash</code> and other popular shells.
<p />
Copy the hw5 template to your turn-in directory thus:
<p />
<code>svn export svn://bits.cs.uic.edu/cs361/pub/homeworks/hw5</code>
<p />
<code>svn add hw5</code>
<p />
You will also need to install the readline developer files:
<p />
<code>sudo apt-get install libreadline-dev</code>
<p />
<h2><a name="PATH_support"></a> PATH support </h2>
<p />
The template code requires the absolute path of the binary you want it to run. Change it to automatically look for the program in all of the directories indicated by PATH, except for filenames that contain a '/'. Thus, make <code>ls</code> do the same thing as <code>/bin/ls</code>, but also make sure that <code>mydir/mybinary</code> still works correctly.
<p />
<strong>HINT</strong>: <code>getenv()</code> to get the environment variable, then <code>strsep()</code> to split it into multiple path strings. Finally, <code>sprintf()</code> to compose a full path out of its components.
<p />
<h2><a name="Commands_with_command_line_argum"></a> Commands with command-line arguments </h2>
<p />
Support up to 10 command line arguments. For example <code>echo hello world</code>, should produce <code>hello world</code>.
<p />
<strong>HINT</strong>: you could use <code>strsep()</code> to split the arguments into an array, which you then pass to <code>execve()</code>.
<p />
<h2><a name="Redirection_to_and_from_files"></a> Redirection to and from files </h2>
<p />
Support stdin and stdout redirection to and from files. For example, <code>ls &gt; /tmp/templ</code> should create a file (with correct permissions) containing the output of ls. Similarly <code>wc &lt; /tmp/templ</code> should use the file as input, and <code>wc &lt; /tmp/templ &gt; /tmp/count</code> uses both input and output redirection.
<p />
<strong>HINT</strong>: use <code>open()</code> to open a file, and <code>dup2()</code> to change where stdin(0) or stdout(1) points to.
<p />
<h2><a name="Piping"></a> Piping </h2>
<p />
Support piping of the stdout from one command to stdin to another. For example:
<p />
<code>ls -l | sort -n -k 5 | cut -c 27-34 &gt; /tmp/sizes</code>
<p />
produces a file containing a sorted list of file sizes.
<p />
<strong>HINT</strong>: this is by far the most challenging part of the homework. Use <code>fork()</code> as in the template code to start up multiple concurrent processes, <code>pipe()</code> to create pipes through which processes communicate, and <code>dup2()</code> to redirect output into and out of pipes. Finally, use <code>waitpid()</code> to wait for child processes to finish.
<p />
<h2><a name="Variable_substitution"></a> Variable substitution </h2>
<p />
The template code already supports interpreted scripts. There are a couple of examples in the template directory, ending with .hw5. Add support for command line arguments to such scripts. For example,
<p />
<pre>
./echo.hw5 hello world
hello world hello
</pre>
<p />
Replace any occurrence of $1,$2,$3 etc with the first, second, third command line argument respectively.
<p />
<strong>HINT</strong>: this one will require some manual string manipulation, but <code>strchr()</code> to find each "$", and <code>strncpy()</code> to copy part or all of strings is a good start.
<p />
<h2><a name="Wildcard_variable_substitution"></a> Wildcard variable substitution </h2>
<strong>WARNING:</strong> this is not yet tested for in the testing script. 
<p />
Replace any occurrence of * in the command line with a list of files in the local directory. To list files, use <code>readdir()</code> and associated functions. 
<p />
<strong>HINT</strong>: you don't need to support anything but the pure * wildcard. However, for extra pound-on-my-hairless-chest geek credit, see if you can figure out how to support things like *.txt,  hw *, and *stuff*and*other*stuff. I'm pretty sure <code>fnmatch()</code> will be handy. 
<p />
<h2><a name="Testing_your_code"></a> Testing your code </h2>
<p />
Try running ./test.hw5. Below is the expected output. Of course, the results from "ls" and the number of files will vary depending on what's in your directory.
<p />
<pre>
./test.hw5
&#42; Echo seems to work
&#42; Now the directory contents:
Makefile   echo.hw5   hw5      hw5.c      hw5.dSYM   hw5.sh~      test.hw5
&#42; Now the number of files:
       7
&#42; Now we should see &#34;Hello World&#34;:
Hello World
&#42; And now the contents of /tmp/countfile
       2
&#42; Now a list of file sizes

     25 
     81 
    102 
    157 
    630 
   3377 
  15336 
&#42; And finally &#34;hello world hello world&#34;
hello world hello world
</pre> </div><!-- /patternTopic-->
<div class="twikiContentFooter"></div></div><!-- /patternContent-->
<a name="topic-actions"></a><div class="patternTopicActions"><div class="patternTopicAction"><span class="patternActionButtons"><span><a href='https://www.cs.uic.edu/bin/edit/CS361fall13/Homework5?t=1543180354' rel='nofollow' title='Edit this topic text' accesskey='e'><span class='twikiAccessKey'>E</span>dit</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/attach/CS361fall13/Homework5' rel='nofollow' title='Attach an image or document to this topic' accesskey='a'><span class='twikiAccessKey'>A</span>ttach</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/view/CS361fall13/Homework5?cover=print' rel='nofollow' title='Printable version of this topic' accesskey='p'><span class='twikiAccessKey'>P</span>rint version</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><span><a href='/bin/rdiff/CS361fall13/Homework5?type=history' rel='nofollow' title='View total topic history' accesskey='h'><span class='twikiAccessKey'>H</span>istory</a></span>: r1</span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/oops/CS361fall13/Homework5?template=backlinksweb' rel='nofollow' title='Search the CS361fall13 Web for topics that link to here' accesskey='b'><span class='twikiAccessKey'>B</span>acklinks</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/view/CS361fall13/Homework5?raw=on' rel='nofollow' title='View raw text without formatting' accesskey='r'><span class='twikiAccessKey'>R</span>aw View</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='https://www.cs.uic.edu/bin/edit/CS361fall13/Homework5?t=1543180354;nowysiwyg=1' rel='nofollow' title='Raw Edit this topic text' accesskey='w'>Ra<span class='twikiAccessKey'>w</span> edit</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/oops/CS361fall13/Homework5?template=oopsmore&amp;param1=1&amp;param2=1' rel='nofollow' title='Delete or rename this topic; set parent topic; view and compare revisions' accesskey='m'><span class='twikiAccessKey'>M</span>ore topic actions</a></span></span></div><!--/patternTopicAction--></div><!--/patternTopicActions--><div class="patternInfo twikiGrayText"><div class="patternRevInfo">Topic revision: r1 - 2013-09-24 - 01:16:58 - Main.jakob</div><!-- /patternRevInfo--><div class="patternMoved"></div><!-- /patternMoved--></div><!-- /patternInfo-->
</div><!-- /patternMainContents-->
</div><!-- /patternMain--><div id="patternLeftBar"><div id="patternClearHeaderLeft"></div>
<div id="patternLeftBarContents"><div class="patternWebIndicator"> <ul>
<li> <a href="/bin/view/CS361fall13/WebHome" class="twikiCurrentWebHomeLink twikiLink"><img src="/pub/TWiki/TWikiDocGraphics/web-bg-small.gif" width="13" height="13" alt="Web background" title="Web background" border="0" /> CS361fall13</a>
</li></ul> 
</div> <ul>
<li> <a href="/bin/view/CS361fall13/Syllabus" class="twikiLink">Syllabus</a>
</li> <li> <a href="/bin/view/CS361fall13/CourseSchedule" class="twikiLink">Homework Schedule</a>
</li> <li> <a href="/bin/view/CS361fall13/LectureNotes" class="twikiLink">Lecture Notes</a>
</li> <li> <a href="/bin/view/CS361fall13/ReadingList" class="twikiLink">Reading List</a>
</li> <li> <a href="/bin/view/CS361fall13/AdditionalMaterial" class="twikiLink">Additional Material</a>
</li> <li> <a href="https://piazza.com/class/hjsnllvm3vc4sy" target="_top">Piazza Board</a>
</li> <li> <a href="https://jakob.signin.aws.amazon.com/console" target="_top">EC2 Sign-In Page</a>
</li></ul> 
</div><!-- /patternLeftBarContents--></div><!-- /patternLeftBar-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--></div><!-- /patternWrapper--><div id="patternTopBar"><div id="patternTopBarContents"><div id="twikiLogo" class="twikiImage">
<map id="logomap" name="logomap">
	<area shape="rect" alt="" title="" coords="144,20,317,74" href="https://www.cs.uic.edu" target=""/>
	<area shape="rect" alt="College of Engineering" title="" coords="125,76,300,91" href="http://www.engineering.uic.edu/" target=""/>
	<area shape="rect" alt="University of Illinois at Chicago" title="" coords="10,20,120,71" href="http://www.uic.edu" target=""/>
</map>
<img src="https://www.cs.uic.edu/pub/cslogo_ds.png" alt="Home - this site is powered by TWiki(R)" border="0" style="border:none;" usemap="#logomap"/>
</div>
<p />
<div style="margin-left:650px; position:relative;">
	<form name="quickSearchForm" method="get" action="https://www.google.com/search">
		<input id=quickSearchBox type="text" class="twikiInputField" name="q" size="18" maxlength="255" value=""/>
		<input type="hidden" name="sitesearch" value="cs.uic.edu"/>
	</form>
</div>
<p />
<div id="menuContainer" style="overflow:visible; position:absolute; z-index:2; width:640px; left:342px; top:58px;">
<div id="navMenu">
<ul>
<li> <a href="#">ABOUT US</a>
	<ul>
	<li><a href="https://www.cs.uic.edu/Main/AboutCS">Our Department</a></li>
	<li><a href="https://www.cs.uic.edu/bin/view/Main/NewsArchive">Recent News</a></li>
	<li><a href="https://www.cs.uic.edu/bin/view/Main/Contact">Contact Us</a></li>
	</ul>
</li>
</ul>
<ul>
<li> <a href="#">ACADEMICS</a>
	<ul>
	<li><a href="/Main/ProspectiveStudents">Prospective Students</a></li>
	<li><a href="/Main/UndergraduatePrograms">Undergraduate</a></li>
	<li><a href="/Main/ComputerScienceMinor">CS Minor</a></li>       
	<li><a href="/Main/GraduatePrograms">Graduate</a></li>
	<li><a href="/Main/Courses">Courses</a></li>
	</ul>
</li>
</ul>
<ul>
<li> <a href="#">RESEARCH</a>
	<ul>
	<li><a href="/Main/Research">Overview</a></li>
	<li><a href="/Main/Faculty-Area">By Faculty</a></li>
	<li><a href="/Main/Research#Labs">Labs</a></li>
	</ul>
</li>
</ul>
<ul>
<li> <a href="#">PEOPLE</a>
	<ul>
	<li><a href="https://www.cs.uic.edu/faculty/">Faculty</a></li>
	<li><a href="https://www.cs.uic.edu/adjuncts/">Adjuncts</a></li>
	<li><a href="https://www.cs.uic.edu/staff">Staff</a></li>
	<li><a href="/Main/Students">Students</a></li>
	<li><a href="/Main/Alumni?y=2015">Alumni</a></li>
	</ul>
</li>
</ul>
<br class="clearFloat"/>
</div>
</div></div></div><!-- /patternTopBar--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="patternWebBottomBar"><table width="100%"><tr>
<td>Copyright 2016 The Board of Trustees<br/> of the University of Illinois.<a href="webmaster@cs.uic.edu">webmaster@cs.uic.edu</a></td>
<td><a href="https://wisest.uic.edu" target=_blank>WISEST<br />Helping Women Faculty Advance<br />Funded by NSF</a> </td><td>  <a href="http://engineering.uic.edu/bin/view/COE/CollegeGift" target="_top"><img alt="" src="https://www.cs.uic.edu/pub/Main/WebHome/gift.jpg" /></a> <a href="http://www1.cs.uic.edu/www/donate.php?audience=public" target="_top"> </a> </td><td> <a target="_blank" href="http://www.cs.uic.edu/CSOpenHouse"><img alt="" src="https://www.cs.uic.edu/pub/Main/WebHome/openHouseButton.gif" border="0" /></a> </td></tr></table></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />