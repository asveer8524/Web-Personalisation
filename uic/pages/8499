<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<head>
<script type="text/javascript" src="/pub/TWiki/JQueryPlugin/jquery.js"></script>
<script type="text/javascript" src="/pub/TWiki/JQueryPlugin/jquery-migrate.js"></script>
<link rel="stylesheet" href="/pub/TWiki/JQueryPlugin/jquery-all.css" type="text/css" media="all" />
<script type="text/javascript" src="/pub/TWiki/JQueryPlugin/jquery-all.js"></script>
<title> Homework2 &lt; CS450 &lt; TWiki</title>

<link rel="icon" href="https://www1.cs.uic.edu/images/favicon.ico" type="image/x-icon" />
<link rel="alternate" href="https://www.cs.uic.edu/bin/edit/CS450/Homework2?_T=2018-11-25" type="application/x-wiki" title="edit Homework2" />
<link rel="shortcut icon" href="https://www1.cs.uic.edu/images/favicon.ico" type="image/x-icon" />
<meta name="SCRIPTURLPATH" content="/bin" />
<meta name="SCRIPTSUFFIX" content="" />
<meta name="TEXT_JUMP" content="Jump" />
<meta name="TEXT_SEARCH" content="Search" />
<meta name="TEXT_NUM_TOPICS" content="Number of topics:" />
<meta name="TEXT_MODIFY_SEARCH" content="Modify search" />
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/bin/view/CS450/WebRss" />
<base href="https://www.cs.uic.edu/bin/view/CS450/Homework2"></base>
<!--BEHAVIOURCONTRIB--><script type="text/javascript" src="/pub/TWiki/BehaviourContrib/behaviour.compressed.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikilib.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiWindow.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiEvent.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiHTML.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiCSS.js"></script>
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiForm.js"></script>
<script type="text/javascript" src="/pub/TWiki/PatternSkin/pattern.js"></script>
<style type="text/css" media="all">
@import url('/pub/TWiki/TWikiTemplates/base.css');
</style>
<style type="text/css" media="all">
#patternTopBar,
#patternClearHeaderCenter,
#patternClearHeaderLeft,
#patternClearHeaderRight,
#patternTopBarContentsOuter,
#patternTopBarContents {
/*	height:64px; */ /* top bar height; make room for header columns */
	overflow:hidden;
}
#patternOuter {
	margin-left:14em;
}
#patternLeftBar {
	width:14em;
	margin-left:-14em;
}
</style>
<style type="text/css" media="all">
@import url('/pub/TWiki/PatternSkin/layout.css');
@import url('/pub/TWiki/PatternSkin/style.css');
@import url('/pub/TWiki/PatternSkin/colors.css');
</style>
<style type="text/css" media="all">
	/* Styles that are set using variables */
	.patternBookView .twikiTopRow,
	.patternWebIndicator a img,
	.patternWebIndicator a:hover img {
		background-color:#D0D0D0;
	}
	#patternTopBarContents { background-image:url(none); background-repeat:no-repeat;}
	
	.patternBookView {
		border-color:#D0D0D0;
	}
	.patternPreviewPage #patternMain {
		/* uncomment to set the preview image */
		/*background-image:url("/pub/TWiki/PreviewBackground/preview2bg.gif");*/
	}
	
</style><style type="text/css" media="all">

@import url('/pub/Main/WebPreferences/mainweb.css');

</style>
<style type="text/css" media="all">
	@import url("/pub/TWiki/PatternSkin/print.css");
</style>
<!--[if IE]><style type="text/css" media="screen">
pre {
	overflow-x:auto;
	padding-bottom:expression(this.scrollWidth > this.offsetWidth ? 16 : 0);
}
</style>
<![endif]-->
<!--[if lte IE 6]> 
<style type="text/css">
#patternLeftBar {
	position:relative; /* IE 5.5 needs this or the contents won't show outside the parent container on print. IE 6.0 needs it only during printable copy! */
}
</style><![endif]-->
<script type="text/javascript" src="/pub/TWiki/TWikiJavascripts/twikiStyles.js"></script>

<!-- Google Analytics Snippet -->

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17081517-1']);
  _gaq.push(['_setDomainName', 'none']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);

  (function() {
	 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + 
'.google-analytics.com/ga.js';
	 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- /Google Analytics Snippet -->
</head>
<body class="patternViewPage">
<a name="PageTop"></a>
<div id="patternScreen">
<div id="patternPageShadow">
<div id="patternPage">
<div id="patternWrapper"><div id="patternOuter">
<div id="patternFloatWrap">
<div id="patternMain"><div id="patternClearHeaderCenter"></div>
<div id="patternMainContents"><div class="patternTop"><span class="patternHomePath twikiLeft"><a href="/bin/view/Main/WebHome" class="twikiLink">TWiki</a><span class='twikiSeparator'>&gt;</span><img src="/pub/TWiki/TWikiDocGraphics/web-bg-small.gif" border="0" alt="" width="13" height="13" style="background-color:#D0D0D0" />&nbsp;<a href="/bin/view/CS450/WebHome">CS450 Web</a><span class='twikiSeparator'>&gt;</span><a href="https://www.cs.uic.edu/bin/view/CS450/Homework2" title='Topic revision: 5 (2013-01-24 - 23:30:27)'>Homework2</a> <span class='patternRevInfo'>(2013-01-24, Main.ckanich)</span></span><!-- /patternHomePath--><span class="patternToolBar twikiRight"><span><a href='https://www.cs.uic.edu/bin/edit/CS450/Homework2?t=1543180254' rel='nofollow' title='Edit this topic text' accesskey='e'><span class='twikiAccessKey'>E</span>dit</a></span><span><a href='/bin/attach/CS450/Homework2' rel='nofollow' title='Attach an image or document to this topic' accesskey='a'><span class='twikiAccessKey'>A</span>ttach</a></span></span><!-- /patternToolBar--><br class="twikiClear" /></div><!--/patternTop--><div class="twikiContentHeader"></div><div class="patternContent"><div class="patternTopic"> <h1><a name="Homework_2_A_Home_Brew_Multi_Thr"></a> Homework 2 - A Home-Brew Multi-Threaded Web Server </h1>
<p />
In this homework, we'll do the server end of http. First export the template in svn://cs450.cs.uic.edu/pub/homeworks/hw2 and add it to your own repository. This time around, the template only contains a Makefile. 
<p />
Based on examples/sockets/server.c, create a web server application that takes a port and a directory name as arguments, and serves the contents of this directory over http. For example, after building hw2, you should be able to run
<p />
<pre>
./hw2 8080 WWW
</pre>
<p />
and then visit <a href="http://localhost:8080/index.html" target="_top">http://localhost:8080/index.html</a>, to see the simple test page in the WWW folder of the hw2 template. Clicking on the link should take you to a second page, than contains an image. You may change the files in the WWW directory, as long as there is at least two pages connected by a link, and at least one image embedded in a page.
<p />
You need to handle the following cases: <ul>
<li> non-existing file: return error 404 with a readable error message, just like a webserver would
</li> <li> html, text, jpeg, gif and png files should all display properly. return the proper HTTP Content-type header, based on the file ending. Also, pdf files should be handled correctly.
</li> <li> if the requested path is a directory, you should handle request as if it was for the file index.html inside that directory. hint: use stat() to determine if a path is a directory or a file. the st_mode field in the stat struct has what you need.
</li> <li> some clients may be slow to complete a connection. Your server should be able to serve multiple clients concurrently, not back-to-back. For this homework, use multithreading with pthreads. We'll try event-based concurrency in hw4.
</li></ul> 
<p />
Note that if you use port 80, there is no need to indicate the port in the URL, and you should also be able to fetch the pages with hw0. However, port 80 requires administrative privileges on your machine, which you may not have, depending on what machine you are doing the homework on.
<p />
HINT: useful libc functions to use are stat(), strstr()/strcasestr(), sprintf(), sscanf(). The code in examples/sockets/server.c should be very helpful. My entire solution, starting from the 68-line server.c, with lots of comments and nice formatting, is 124 lines. Think before you code and try to keep your code manageable.
<p />
<h2><a name="Turn_in"></a> Turn-in </h2>
<p />
Commit your finished homework at:
<p />
svn://cs450.cs.uic.edu/s13/yournetid/hw2
<p />
where, obviously, yournamehere should be replaced by your UIC netid. To ensure that your submission is complete, follow the procedure that we will use when grading your homework. 
<p />
First, in a brand new, empty directory, do the following:
<p />
<pre>
svn export svn://cs450.cs.uic.edu/s13/yournetid/hw2
cd hw2
make
./hw2 8080 WWW
</pre>
and now visit <a href="http://localhost:8080/" target="_top">http://localhost:8080/</a> and click the link, using firefox and perhaps one other browser.
<p />
Once everything looks right to you, run the automatic grading script in pub/grading-scripts/hw2. 
<p />
<h2><a name="Grading"></a> Grading </h2>
Grading will be done automatically using a script. You can check your grade before final submission using the script. You can get the grading script using:
<p />
<code>svn co svn://cs450.cs.uic.edu/pub/</code>
<p />
or just <code>svn up</code> in your <code>/pub</code> if you already have one checked out. The grading script is in /pub/grading-scripts/hw2/. To run the grading script:
<p />
<code>./hw2_score username port score_file</code>
<p />
This script will create a directory with your username, download hw2 from svn and create output_file and score_file inside hw2. Check the score_file to see how your solution is doing.  </div><!-- /patternTopic-->
<div class="twikiContentFooter"></div></div><!-- /patternContent-->
<a name="topic-actions"></a><div class="patternTopicActions"><div class="patternTopicAction"><span class="patternActionButtons"><span><a href='https://www.cs.uic.edu/bin/edit/CS450/Homework2?t=1543180254' rel='nofollow' title='Edit this topic text' accesskey='e'><span class='twikiAccessKey'>E</span>dit</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/attach/CS450/Homework2' rel='nofollow' title='Attach an image or document to this topic' accesskey='a'><span class='twikiAccessKey'>A</span>ttach</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/view/CS450/Homework2?cover=print' rel='nofollow' title='Printable version of this topic' accesskey='p'><span class='twikiAccessKey'>P</span>rint version</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><span><a href='/bin/rdiff/CS450/Homework2?type=history' rel='nofollow' title='View total topic history' accesskey='h'><span class='twikiAccessKey'>H</span>istory</a></span>: r5&nbsp;<a rel="nofollow" href="/bin/rdiff/CS450/Homework2?rev1=5;rev2=4">&lt;</a>&nbsp;<a rel="nofollow" href="/bin/view/CS450/Homework2?rev=4">r4</a>&nbsp;<a rel="nofollow" href="/bin/rdiff/CS450/Homework2?rev1=4;rev2=3">&lt;</a>&nbsp;<a rel="nofollow" href="/bin/view/CS450/Homework2?rev=3">r3</a>&nbsp;<a rel="nofollow" href="/bin/rdiff/CS450/Homework2?rev1=3;rev2=2">&lt;</a>&nbsp;<a rel="nofollow" href="/bin/view/CS450/Homework2?rev=2">r2</a>&nbsp;<a rel="nofollow" href="/bin/rdiff/CS450/Homework2?rev1=2;rev2=1">&lt;</a>&nbsp;<a rel="nofollow" href="/bin/view/CS450/Homework2?rev=1">r1</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/oops/CS450/Homework2?template=backlinksweb' rel='nofollow' title='Search the CS450 Web for topics that link to here' accesskey='b'><span class='twikiAccessKey'>B</span>acklinks</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/view/CS450/Homework2?raw=on' rel='nofollow' title='View raw text without formatting' accesskey='r'><span class='twikiAccessKey'>R</span>aw View</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='https://www.cs.uic.edu/bin/edit/CS450/Homework2?t=1543180254;nowysiwyg=1' rel='nofollow' title='Raw Edit this topic text' accesskey='w'>Ra<span class='twikiAccessKey'>w</span> edit</a></span><span class='twikiSeparator'>&nbsp;|&nbsp;</span><span><a href='/bin/oops/CS450/Homework2?template=oopsmore&amp;param1=5&amp;param2=5' rel='nofollow' title='Delete or rename this topic; set parent topic; view and compare revisions' accesskey='m'><span class='twikiAccessKey'>M</span>ore topic actions</a></span></span></div><!--/patternTopicAction--></div><!--/patternTopicActions--><div class="patternInfo twikiGrayText"><div class="patternRevInfo">Topic revision: r5 - 2013-01-24 - 23:30:27 - Main.ckanich</div><!-- /patternRevInfo--><div class="patternMoved"></div><!-- /patternMoved--></div><!-- /patternInfo-->
</div><!-- /patternMainContents-->
</div><!-- /patternMain--><div id="patternLeftBar"><div id="patternClearHeaderLeft"></div>
<div id="patternLeftBarContents"><div class="patternWebIndicator"> <ul>
<li> <a href="/bin/view/CS450/WebHome" class="twikiCurrentWebHomeLink twikiLink"><img src="/pub/TWiki/TWikiDocGraphics/web-bg-small.gif" width="13" height="13" alt="Web background" title="Web background" border="0" /> CS450</a>
</li></ul> 
</div> <ul>
<li> <a href="/bin/view/CS450/WebHome" class="twikiCurrentWebHomeLink twikiLink">CS450 Home</a>
</li> <li> <a href="/bin/view/CS450/Syllabus" class="twikiLink">Syllabus</a>
</li> <li> <a href="/bin/view/CS450/Homeworks" class="twikiLink">Homeworks</a>
</li> <li> - <a href="/bin/view/CS450/UsingSubversion" class="twikiLink">Using Subversion</a>
</li> <li> <a href="https://piazza.com/class#spring2013/cs450" target="_top">Discussion Forum</a>
</li> <li> <a href="/bin/view/CS450/LectureNotes" class="twikiLink">Lecture Notes</a>
</li></ul> 
<hr />
<div class="patternLeftBarPersonal">
<ul><li class="patternLogIn"><a href="/bin/logon/CS450/Homework2">Log In</a> </li></ul>
</div><!--/patternLeftBarPersonal-->
<p /> <ul>
<li> <strong><a href="/bin/view/CS450/WebHome" class="twikiCurrentWebHomeLink twikiLink"> <img src="/pub/TWiki/TWikiDocGraphics/home.gif" width="16" height="16" alt="Home" title="Home" border="0" /> CS450 Web</a></strong>
</li> <li> <a href="/bin/view/CS450/WebCreateNewTopic?topicparent=Homework2" target="_top"> <img src="/pub/TWiki/TWikiDocGraphics/newtopic.gif" width="16" height="16" alt="New topic" title="New topic" border="0" /> Create New Topic</a>
</li> <li> <a href="/bin/view/CS450/WebTopicList" class="twikiLink"> <img src="/pub/TWiki/TWikiDocGraphics/index.gif" width="16" height="16" alt="Index" title="Index" border="0" /> Index</a>
</li> <li> <a href="/bin/view/CS450/WebSearch" class="twikiLink"> <img src="/pub/TWiki/TWikiDocGraphics/searchtopic.gif" width="16" height="16" alt="Search topic" title="Search topic" border="0" /> Search</a>
</li> <li> <a href="/bin/view/CS450/WebChanges" class="twikiLink"> <img src="/pub/TWiki/TWikiDocGraphics/changes.gif" width="16" height="16" alt="Changes" title="Changes" border="0" /> Changes</a>
</li> <li> <a href="/bin/view/CS450/WebNotify" class="twikiLink"> <img src="/pub/TWiki/TWikiDocGraphics/notify.gif" width="16" height="16" alt="Notify" title="Notify" border="0" /> Notifications</a>
</li> <li> <a href="/bin/view/CS450/WebRss" class="twikiLink"> <img src="/pub/TWiki/TWikiDocGraphics/feed.gif" width="16" height="16" alt="RSS feed, rounded corners" title="RSS feed, rounded corners" border="0" /> RSS Feed</a>
</li> <li> <a href="/bin/view/CS450/WebStatistics" class="twikiLink"> <img src="/pub/TWiki/TWikiDocGraphics/statistics.gif" width="16" height="16" alt="Statistics" title="Statistics" border="0" /> Statistics</a>
</li> <li> <a href="/bin/view/CS450/WebPreferences" class="twikiLink"> <img src="/pub/TWiki/TWikiDocGraphics/wrench.gif" width="16" height="16" alt="Wrench, tools" title="Wrench, tools" border="0" /> Preferences</a>
</li></ul> 
<p />
<hr />
</div><!-- /patternLeftBarContents--></div><!-- /patternLeftBar-->
</div><!-- /patternFloatWrap-->
<div class="clear">&nbsp;</div>
</div><!-- /patternOuter--></div><!-- /patternWrapper--><div id="patternTopBar"><div id="patternTopBarContents"><div id="twikiLogo" class="twikiImage">
<map id="logomap" name="logomap">
	<area shape="rect" alt="" title="" coords="144,20,317,74" href="https://www.cs.uic.edu" target=""/>
	<area shape="rect" alt="College of Engineering" title="" coords="125,76,300,91" href="http://www.engineering.uic.edu/" target=""/>
	<area shape="rect" alt="University of Illinois at Chicago" title="" coords="10,20,120,71" href="http://www.uic.edu" target=""/>
</map>
<img src="https://www.cs.uic.edu/pub/cslogo_ds.png" alt="Home - this site is powered by TWiki(R)" border="0" style="border:none;" usemap="#logomap"/>
</div>
<p />
<div style="margin-left:650px; position:relative;">
	<form name="quickSearchForm" method="get" action="https://www.google.com/search">
		<input id=quickSearchBox type="text" class="twikiInputField" name="q" size="18" maxlength="255" value=""/>
		<input type="hidden" name="sitesearch" value="cs.uic.edu"/>
	</form>
</div>
<p />
<div id="menuContainer" style="overflow:visible; position:absolute; z-index:2; width:640px; left:342px; top:58px;">
<div id="navMenu">
<ul>
<li> <a href="#">ABOUT US</a>
	<ul>
	<li><a href="https://www.cs.uic.edu/Main/AboutCS">Our Department</a></li>
	<li><a href="https://www.cs.uic.edu/bin/view/Main/NewsArchive">Recent News</a></li>
	<li><a href="https://www.cs.uic.edu/bin/view/Main/Contact">Contact Us</a></li>
	</ul>
</li>
</ul>
<ul>
<li> <a href="#">ACADEMICS</a>
	<ul>
	<li><a href="/Main/ProspectiveStudents">Prospective Students</a></li>
	<li><a href="/Main/UndergraduatePrograms">Undergraduate</a></li>
	<li><a href="/Main/ComputerScienceMinor">CS Minor</a></li>       
	<li><a href="/Main/GraduatePrograms">Graduate</a></li>
	<li><a href="/Main/Courses">Courses</a></li>
	</ul>
</li>
</ul>
<ul>
<li> <a href="#">RESEARCH</a>
	<ul>
	<li><a href="/Main/Research">Overview</a></li>
	<li><a href="/Main/Faculty-Area">By Faculty</a></li>
	<li><a href="/Main/Research#Labs">Labs</a></li>
	</ul>
</li>
</ul>
<ul>
<li> <a href="#">PEOPLE</a>
	<ul>
	<li><a href="https://www.cs.uic.edu/faculty/">Faculty</a></li>
	<li><a href="https://www.cs.uic.edu/adjuncts/">Adjuncts</a></li>
	<li><a href="https://www.cs.uic.edu/staff">Staff</a></li>
	<li><a href="/Main/Students">Students</a></li>
	<li><a href="/Main/Alumni?y=2015">Alumni</a></li>
	</ul>
</li>
</ul>
<br class="clearFloat"/>
</div>
</div></div></div><!-- /patternTopBar--><div id="patternBottomBar"><div id="patternBottomBarContents"><div id="patternWebBottomBar"><table width="100%"><tr>
<td>Copyright 2016 The Board of Trustees<br/> of the University of Illinois.<a href="webmaster@cs.uic.edu">webmaster@cs.uic.edu</a></td>
<td><a href="https://wisest.uic.edu" target=_blank>WISEST<br />Helping Women Faculty Advance<br />Funded by NSF</a> </td><td>  <a href="http://engineering.uic.edu/bin/view/COE/CollegeGift" target="_top"><img alt="" src="https://www.cs.uic.edu/pub/Main/WebHome/gift.jpg" /></a> <a href="http://www1.cs.uic.edu/www/donate.php?audience=public" target="_top"> </a> </td><td> <a target="_blank" href="http://www.cs.uic.edu/CSOpenHouse"><img alt="" src="https://www.cs.uic.edu/pub/Main/WebHome/openHouseButton.gif" border="0" /></a> </td></tr></table></div><!--/patternWebBottomBar--></div><!-- /patternBottomBarContents--></div><!-- /patternBottomBar-->
</div><!-- /patternPage-->
</div><!-- /patternPageShadow-->
</div><!-- /patternScreen-->
</body></html>
<p />